
m = 10;
n = 5;

A = zeros(m, n);

for i = 1:m
    for j = 1:n
        A(i, j) = i + 1j*j;
    end
end

[Q, R] = qr(A);

%      The matrix Q is  represented  as  a  product  of  elementary
%      reflectors
% 
%         Q = H(1) H(2) . . . H(k), where k = min(m,n).
% 
%      Each H(i) has the form
%         H(i) = I - tau * v * v'
% 
%      where tau is a real scalar, and v is a real vector with
%      v(1:i-1) = 0 and v(i) = 1; v(i+1:m) is  stored  on  exit  in
%      A(i+1:m,i), and tau in TAU(i).

A1 = [-19.8746 +   0.0000j    -20.3778 +  -2.7674j    -20.8809 +  -5.5347j    -21.3841 +  -8.3021j    -21.8872 + -11.0694j;
      0.0979 +   0.0432j     -1.4452 +   0.0000j     -2.8904 +  -0.0000j     -4.3356 +  -0.0000j     -5.7808 +  -0.0000j;
      0.1457 +   0.0409j      0.1387 +   0.2220j     -0.0000 +   0.0000j     -0.0000 +  -0.0000j     -0.0000 +  -0.0000j;
      0.1935 +   0.0386j      0.0816 +   0.1296j     -0.1458 +  -0.0688j     -0.0000 +   0.0000j     -0.0000 +   0.0000j;
      0.2413 +   0.0363j      0.0245 +   0.0371j      0.0212 +  -0.0111j     -0.3242 +  -0.2114j      0.0000 +   0.0000j;
      0.2891 +   0.0341j     -0.0326 +  -0.0553j     -0.2312 +  -0.1112j      0.0356 +   0.2057j      0.2768 +  -0.3919j;
      0.3369 +   0.0318j     -0.0897 +  -0.1478j     -0.2982 +   0.0481j     -0.0588 +   0.2099j     -0.0076 +  -0.0179j;
      0.3847 +   0.0295j     -0.1468 +  -0.2402j     -0.1326 +   0.1191j      0.4884 +   0.0909j      0.2930 +  -0.2068j;
      0.4324 +   0.0272j     -0.2040 +  -0.3327j      0.2071 +   0.1819j     -0.4702 +   0.4891j     -0.3225 +  -0.4816j;
      0.4802 +   0.0249j     -0.2611 +  -0.4251j      0.6097 +   0.2781j     -0.0568 +   0.1606j      0.0585 +   0.3090j];

tau = [1.0503 +   0.0503j;
      1.0786 +   0.4217j;
      1.1362 +  -0.1211j;
      1.0100 +  -0.0404j;
      1.1132 +  -0.0422j;
      0.0000 +   0.0000j;
      0.0000 +   0.0000j;
      0.0000 +   0.0000j;
      0.0000 +   0.0000j;
      0.0000 +   0.0000j];

[Q1, R1] = qrf_elem_reflection(A1, tau);

Q
Q1

R
R1

